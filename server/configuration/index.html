<!DOCTYPE html>
<html class="no-js">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Configuration  &middot; Yarra Framework</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="" />

<meta name="keywords" content="">

<meta property="og:title" content="Configuration  &middot; Yarra Framework ">
<meta property="og:site_name" content="Yarra Framework"/>
<meta property="og:url" content="http://yarra-framework.org/server/configuration/" />
<meta property="og:locale" content="en-us">


<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="2018-06-15T00:00:00Z" />
<meta property="og:article:modified_time" content="2018-06-15T00:00:00Z" />

  

<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "Configuration",
    "author": {
      "@type": "Person",
      "name": "http://profiles.google.com/+?rel=author"
    },
    "datePublished": "2018-06-15",
    "description": "",
    "wordCount": 1145
  }
</script>


<link rel="canonical" href="http://yarra-framework.org/server/configuration/" />

<meta name="generator" content="Hugo 0.54.0" />


  <link rel="stylesheet" href="/assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="stylesheet" href="/assets/css/yarra.css">

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-63470225-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-63470225-3');
  </script>

</head>
<body>
<nav class="navbar navbar-expand-lg fixed-top site-navbar navbar-inverse">
  <a class="navbar-brand text-white" href="http://yarra-framework.org/">Yarra Framework</a>
  <button class="navbar-toggler text-white" 
  type="button" data-toggle="collapse" data-target="#exCollapsingNavbar2" aria-controls="exCollapsingNavbar2"
    aria-expanded="false" aria-label="Toggle navigation">
    &#9776;
  </button>
  <div class="collapse navbar-collapse" id="exCollapsingNavbar2">
    <ul class="nav navbar-nav ml-1 mr-auto">
               
        
        <li class="nav-item">
          <a class="nav-link menu-item " href="/overview">
            
            <span class="text-capitalize no-decoration text-white">Overview</span>
          </a>
        </li>
        
              
        
        <li class="nav-item">
          <a class="nav-link menu-item " href="/clients">
            
            <span class="text-capitalize no-decoration text-white">Clients</span>
          </a>
        </li>
        
              
        
        <li class="nav-item">
          <a class="nav-link menu-item active" href="/server">
            
            <span class="text-capitalize no-decoration text-white">Server</span>
          </a>
        </li>
        
              
        
        <li class="nav-item">
          <a class="nav-link menu-item " href="/modules">
            
            <span class="text-capitalize no-decoration text-white">Modules</span>
          </a>
        </li>
        
              
        
        <li class="nav-item">
          <a class="nav-link menu-item " href="/logserver">
            
            <span class="text-capitalize no-decoration text-white">LogServer</span>
          </a>
        </li>
        
              
        
        <li class="nav-item">
          <a class="nav-link menu-item " href="/addons">
            
            <span class="text-capitalize no-decoration text-white">Addons</span>
          </a>
        </li>
        
              
        
        <li class="nav-item">
          <a class="nav-link menu-item " href="/download">
            
            <span class="text-capitalize no-decoration text-white">Download</span>
          </a>
        </li>
        
              
        
        <li class="nav-item">
          <a class="nav-link menu-item " href="/blog">
            
            <span class="text-capitalize no-decoration text-white">Blog</span>
          </a>
        </li>
        
              
        
              
        
              
        
      
    </ul>
  </div>
</nav>


<div class="container p-a-0">
  <div class="row m-l-0 m-r-0 mb-2">
    <div class="col">
      <h1>Server&nbsp;-&nbsp;Configuration</h1>
    </div>
  </div>
    <div class="row m-l-0 m-r-0">
      <div class="col-xs-12 col-lg-3">
      <div class="list-group mr-3 mb-4">
        <a href="http://yarra-framework.org/server/" class="list-group-item list-group-item-action">Overview</a>
        
        
        
        <a href="/server/installation/" class="list-group-item list-group-item-action ">&ndash;&nbsp; Installation</a>
        
        <a href="/server/configuration/" class="list-group-item list-group-item-action active">&ndash;&nbsp; Configuration</a>
        
        <a href="/server/webgui/" class="list-group-item list-group-item-action ">&ndash;&nbsp; WebGUI</a>
        
        <a href="/server/usage/" class="list-group-item list-group-item-action ">&ndash;&nbsp; Manual Control</a>
        
        <a href="/server/modes/" class="list-group-item list-group-item-action ">&ndash;&nbsp; Reconstruction Modes</a>
        
        <a href="/server/notifications/" class="list-group-item list-group-item-action ">&ndash;&nbsp; Notifications</a>
        
        <a href="/server/loadbalancing/" class="list-group-item list-group-item-action ">&ndash;&nbsp; Load Balancing</a>
        
      </div>
    </div>
    <div class="col-xs-12 col-lg-9 post-container">
      <div class="content pt-2">
  

<h3 id="hahahugoshortcode-0xc000e1ca00-1-hbhb">
<i class="fas fa-angle-double-right" style="color: #580F8B; font-size: 24px;">&nbsp;</i>Directory Structure

</h3>

<p>After the initial installation, the YarraServer folder has the following directory structure:</p>

<div class='table  table-hover'>
    <table>
<thead>
<tr>
<th>Path</th>
<th>Purpose</th>
</tr>
</thead>

<tbody>
<tr>
<td>fail/</td>
<td>Target folder for failed reconstruction tasks</td>
</tr>

<tr>
<td>finished/</td>
<td>Target folder for completed tasks (if data should be kept)</td>
</tr>

<tr>
<td>install/</td>
<td>Folder with supplementary files for the installation</td>
</tr>

<tr>
<td>log/</td>
<td>Folder for log files</td>
</tr>

<tr>
<td>modes/</td>
<td>Folder with definitions of reconstruction modes</td>
</tr>

<tr>
<td>modules/</td>
<td>Folder with binaries of core processing modules (shipped with Yarra)</td>
</tr>

<tr>
<td>modules_user/</td>
<td>Folder with binaries of custom-developed modules</td>
</tr>

<tr>
<td>queue/</td>
<td>Queue directory with incoming reconstruction tasks</td>
</tr>

<tr>
<td>webgui/</td>
<td>Folder for the web-based user interface</td>
</tr>

<tr>
<td>work/</td>
<td>Working directory for temporary files during processing</td>
</tr>
</tbody>
</table>

  </div>

<p>By default, these folders are local subfolders in the ~/yarra installation directory. However, if necessary because of a special server configuration, the paths of these directories can also be overwritten in the file YarraServer.ini (see next section). In this way, it is possible, for example, to read the reconstruction-mode files from a remote directory shared across multiple servers, which can make it easier to manage installations with multiple processing servers. Adapting the paths is also necessary when the local drives have been configured such that only limited disk space is available in the home folder for the user yarraserver. Note: To run the server, it is necessary that sufficient disk space is available in the fail, finished, queue, and work folders (disk space in the order of 1TB is recommended).
<div style="margin-bottom: 40px; font-size: 0px;">&nbsp;</div></p>

<h3 id="hahahugoshortcode-0xc000e1ca00-4-hbhb">
<i class="fas fa-angle-double-right" style="color: #580F8B; font-size: 24px;">&nbsp;</i>Main Configuration File

</h3>

<p>The main settings of the YarraServer are defined in the file YarraServer.ini, which is located in the installation folder /yarra. This file can be edited with any texteditor, e.g. gedit or nano. After changing the settings in this file, it is necessary to reboot the server (see section <a href="/server/usage">Usage</a>). Most settings in the file are optional. If they are not set, a default value will be used. To overwrite settings, remove the semicolon in front of the entries and write the desired value behind the equal sign.</p>

<p>The following box shows the default file with descriptions of the possible settings:</p>

<pre><code>;### Configuration file for YarraServer ###
 
;# Note: Most entries in this file are optional and default values will be used.
;# Remove the semicolon in front of the entries to overwrite the defaults.
 
[Server]
;# Unique name for identifying the server 
Name=YarraServer
  
[Paths]
;# Uncomment the following lines to overwrite the default location
;# of the individual Yarra subfolders. Normally, this is not needed. 
 
;Log=/path/to/use
;Modes=/path/to/use
;Queue=/path/to/use
;Work=/path/to/use
;Fail=/path/to/use
;Storage=/path/to/use
;Modules=/path/to/use
 
;# Defines the Matlab binary including path, if installed on server
;MatlabBinary=/path/to/use/matlab
 
[Notification]
;# Defines if notification emails should be sent or not
;Enabled=true
 
;# Email addresses that always should receive an email if a task 
;# reports an error. Multiple addresses can be separated with comma.
;ErrorMail=
 
;# If emails should only be sent to addresses within a certain domain (because
;# of data protection), the domain should be listed here, e.g. @nyumc.org
;DomainRestriction=
 
;# Allows overwriting the sender address that YarraServer is using for notifications
;FromAddress=YarraServer &lt;noreply@localhost&gt;
 
[Options]
;# Set to true if tasks with &quot;night&quot; priority should only be processed during night time
;UseNightTasks=false
 
;# Defines the start of the night time (24-hour notation)
;NightStart=23:00:00
 
;# Defines the end of the night time (24-hour notation)
;NightEnd=05:00:00
 
;# Defines the minimum amount of diskspace (in GB) that needs to be available in the 
;# work, fail, and finished directories. If less diskspace is available, task processing
;# will be halted and an error notification mail will be sent
;DriveSpaceNeeded=20
 
;# Defines a notification threshold for the available diskspace (in GB). If less diskspace 
;# is available, a notification will be sent informing the administrators that processing 
;# will soon not be possible anymore. Reminders will be sent every 4 hours
;DriveSpaceNotificationThreshold=0
 
;# Defines a memory threshold in percentage of the physical available memory. If a 
;# reconstruction module uses more than the specified amount of the available memory, the
;# process will be terminated (to prevent that the server starts servere diskswapping,
;# which could make the server unresponsive). This setting can be overwritten for 
;# individual reconstruction modes
;MemKillThreshold=95
 
;# Maximum allowed runtime for reconstruction modules (in ms). If modules run longer than
;# the specified value, they will be terminated and an error notification is sent.
;ProcessTimeout=86400000
</code></pre>

<div style="margin-bottom: 40px; font-size: 0px;">&nbsp;</div>

<h3 id="hahahugoshortcode-0xc000e1ca00-6-hbhb">
<i class="fas fa-angle-double-right" style="color: #580F8B; font-size: 24px;">&nbsp;</i>Queue Configuration File

</h3>

<p>In addition to the main configuration file, the queue directory contains the file YarraServer.cfg, which also contains the name of the server. The purpose of this file is to provide the server information to the Yarra clients. By default, this file is write locked. To edit the file, it is necessary to first change the file permissions to (this should be done when logged in with the user yarraserver):</p>

<pre><code>chmod 640 queue/YarraServer.cfg 
nano queue/YarraServer.cfg
</code></pre>

<p>The following shows the content of the file. The settings should matched with the file YarraServer.ini, as described above.</p>

<pre><code>[YarraServer]
Name=YarraServer
</code></pre>

<p>After editing the file, the permission should be set back to read-only by typing:</p>

<pre><code>chmod 440 queue/YarraServer.cfg
</code></pre>

<div style="margin-bottom: 40px; font-size: 0px;">&nbsp;</div>

<h3 id="hahahugoshortcode-0xc000e1ca00-8-hbhb">
<i class="fas fa-angle-double-right" style="color: #580F8B; font-size: 24px;">&nbsp;</i>Installing the Server as Daemon

</h3>

<p>It is possible to run the server either as normal command-shell application or as Linux daemon (system service). The latter is highly recommended when using the server routinely. When running YarraServer as daemon, it will be started automatically when the server is booted. In addition, it will be automatically restarted in the case that the software should crash for some reason. Running YarraServer as daemon is also necessary when using the Yarra WebGUI.</p>


<div class="bs-callout bs-callout-info"  >
    
<p>The configuration of the daemon has changed from previous Yarra versions, as Ubuntu switched from Upstart to systemd for managing daemons (starting with version 16.04).</p>
</div>



<p>To install the YarraServer as daemon, open a terminal with administrator rights (admin account). Edit the file yarra.service, which is located in the /yarra/install subfolder. By default, this file should read:</p>

<pre><code>[Unit]
Description=Yarra Server
Documentation=http://yarraframework.com
After=smbd.service
Requires=smbd.service

[Service]
Type=simple
User=yarraserver
WorkingDirectory=/home/yarraserver/yarra
ExecStart=/home/yarraserver/yarra/YarraServer --force

Restart=on-failure
RestartSec=3

KillSignal=SIGURG
TimeoutStopSec=43800

[Install]
WantedBy=multi-user.target
</code></pre>

<p>Depending on the location of your YarraServer installation, it is necessary to adjust the path of the &ldquo;EnvironmentFile=&rdquo; file and its content (this file specifies where the Qt binaries are located). It might also be necessary to adapt the &ldquo;User=&rdquo; setting if a different user name for running YarraServer is used.</p>

<p>Copy the yarra.service file to the directory /etc/systemd/system (this can only be done using administrator rights):</p>

<pre><code>sudo cp yarra.service /etc/systemd/system
</code></pre>

<p>Then, activate the Yarra daemon by typing:</p>

<pre><code>sudo systemctl enable yarra
</code></pre>

<p>
<div class="bs-callout bs-callout-primary"  >
    
<p>If the daemon fails to start, you can display the error log using the following command: <br>journalctl -u yarra</p>
</div>


<div style="margin-bottom: 10px; font-size: 0px;">&nbsp;</div></p>

<p>Finally, edit file /etc/sudoers by typing:</p>

<pre><code>sudo nano /etc/sudoers
</code></pre>

<p>and adding the following lines at the end of the file (this already includes the entries for the WebGUI):</p>

<pre><code>yarraserver ALL = (root) NOPASSWD: /bin/systemctl start yarra, /bin/systemctl stop yarra
yarraserver ALL = (root) NOPASSWD: /bin/systemctl start yarrawebgui, /bin/systemctl stop yarrawebgui, /bin/systemctl restart yarrawebgui
</code></pre>

<p>Now, the configuration of the YarraServer is (almost) completed. It is recommended to continue with the installation of the <a href="/server/webgui">WebGUI</a>.</p>

</div>

      
    </div>
  </div>
</div>
      <footer style="margin-top: 100px;">
    <div class="container">
        <div class="row">
            <div class="col-md-8">
                <ul class="list-inline pull-left">
                    
                         
                         
                          <li><a class="page-scroll" href="/">Home</a></li>
                          <li class="footer-menu-divider">&vert;</li> 
                        
                          <li><a class="page-scroll" href="/disclaimer/">Disclaimer</a></li>
                          <li class="footer-menu-divider">&vert;</li> 
                        
                          <li><a class="page-scroll" href="/license/">License</a></li>
                           
                         
                    
                </ul>
            </div>
            <div class="col-md-4">
            <div class="pull-right">
            <a href="http://cai2r.net" target="_blank"><img class="cai2rlogo" src="/assets/img/cai2r.png" height="65"></a>
            </div>
            </div>
        </div>
    </div>
</footer>

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha256-xaF9RpdtRxzwYMWg4ldJoyPWqyDPCRD0Cv7YEEe6Ie8=" crossorigin="anonymous"></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>

<script>
hljs.configure({
  languages: []
})
hljs.initHighlightingOnLoad();
</script>

<script src="/assets/js/script.js"></script>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'yarra-dev/Support'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>


  </body>
</html>

